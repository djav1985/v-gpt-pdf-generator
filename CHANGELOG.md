# Changelog

All notable changes to this project will be documented in this file.
See [standard-version](https://github.com/conventional-changelog/standard-version) for commit guidelines.

## [Unreleased]
### Added
- `CreatePDFResponse` model and request field examples.
- Secured API key handling and enriched route metadata.
- Initial test suite covering API key validation, PDF creation endpoint, and downloads cleanup.
- Expanded tests for PDF generation helper, request model validation, authentication edge cases, cleanup errors, and route handling.
- `ErrorResponse` model for consistent error payloads.
- Download endpoint for serving generated PDFs.
- Custom OpenAPI generator with API key header metadata and URI format for PDF URLs.
- Expanded `ErrorResponse` fields and documented examples across endpoints.
- Added descriptive download endpoint route and comprehensive OpenAPI metadata including server URLs.
- Regression tests for path traversal and case-insensitive code blocks.
- Centralized environment configuration with `Settings` model.
### Removed
- Autogenerated `openapi.json` file from version control.
 - Unused dependencies `aiohttp` and `beautifulsoup4`.
### Changed
- Switched authentication to use `X-API-Key` header instead of `Authorization` bearer token.
- Added strict validation for `CreatePDFRequest` fields including title length, content sanitization, CSS restrictions, and normalized output filenames.
- Simplified OpenAPI server configuration using `BASE_URL` and `ROOT_PATH` environment variables.
- Replaced deprecated `@validator` decorators with Pydantic v2 `@field_validator` in `CreatePDFRequest`.
- Manage startup and shutdown with FastAPI lifespan context.
- Refactored blocking operations using `asyncio.to_thread` and converted several async helpers to synchronous functions.
- Hardened download route against path traversal.
- Made code-block detection regex whitespace-tolerant and case-insensitive.
- Clarified `docker-compose` environment variables.
- Adopted Pydantic v2 `ConfigDict` configuration for `CreatePDFResponse`.
- Restricted model responses to forbid extra fields and return `CreatePDFResponse` from the create route.
- Pass CSS content directly to the PDF generator without forcing an empty string.
- Used timezone-aware datetimes and refactored downloads cleanup with `pathlib`.
- Narrowed exception handling with explicit logging.
- Documented create route with type hints and docstring.
- Strengthened download route path validation with explicit containment checks.
- Updated OpenAPI API key metadata and standardized 500-level PDF generation error codes.
- Clarified README instructions for retrieving the OpenAPI schema from the running service.
### Fixed
- Improved cleanup error test to simulate `Path.iterdir` failure.
- Create endpoint now returns a relative download URL when `BASE_URL` is unset instead of failing.
